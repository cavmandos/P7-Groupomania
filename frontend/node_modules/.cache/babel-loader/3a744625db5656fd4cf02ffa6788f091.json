{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nexport default {\n  name: \"App\",\n  data: function data() {\n    return {\n      user: {},\n      //TEST A CONFIRMER\n      newEmail: \"\",\n      newBio: \"\",\n      newUser: {\n        email: \"\",\n        password: \"\",\n        cPassword: \"\",\n        bio: \"\",\n        image: \"\"\n      }\n    };\n  },\n  methods: {\n    exitSession: function exitSession() {\n      this.$router.push(\"/\");\n      localStorage.clear();\n    },\n    returnMain: function returnMain() {\n      this.$router.push(\"/main\");\n    },\n    // Update img\n    updateImg: function updateImg() {\n      if (this.newUser.image !== \"\") {\n        var userId = this.currentUser.userId;\n        var formData = new FormData();\n        formData.append(\"image\", this.newUser.image);\n        axios.put(\"http://localhost:3000/api/users/\".concat(userId), formData, {\n          headers: {\n            \"content-type\": \"multipart/form-data\",\n            Authorization: \"Bearer \" + this.currentUser.token\n          }\n        }).then(function (res) {\n          console.log(res.data);\n          Swal.fire({\n            text: \"Modification image réussie\",\n            footer: \"Redirection en cours...\",\n            icon: \"success\",\n            timer: 1000,\n            showConfirmButton: false,\n            timerProgressBar: true,\n            willClose: function willClose() {\n              location.reload();\n            }\n          });\n        }).catch(function (error) {\n          console.log(error.response.data.error);\n        });\n      } else {\n        alert(\"Choisissez une image !\");\n      }\n    },\n    // Update EMAIL\n    updateEmail: function updateEmail() {\n      var local = JSON.parse(localStorage.user);\n      var userId = local.userId;\n      var token = local.token;\n      axios.put(\"http://localhost:3000/auth/update/\" + userId, {\n        email: this.newEmail\n      }, {\n        headers: {\n          Authorization: \"Bearer \" + token\n        }\n      }).then(function (res) {\n        console.log(res.data);\n        Swal.fire({\n          text: \"Modification de l'adresse Email réussie !\",\n          footer: \"Redirection en cours...\",\n          icon: \"success\",\n          timer: 1000,\n          showConfirmButton: false,\n          timerProgressBar: true,\n          willClose: function willClose() {\n            location.reload();\n          }\n        });\n      }).catch(function (error) {\n        console.log(error.response.data.error);\n      });\n    },\n    // Update PASSWORD\n    updatePassword: function updatePassword() {\n      var local = JSON.parse(localStorage.user);\n      var userId = local.userId;\n      var token = local.token;\n\n      if (this.newPassword === this.newPasswordConfirm) {\n        axios.put(\"http://localhost:3000/auth/update/\" + userId, {\n          password: this.newPassword\n        }, {\n          headers: {\n            Authorization: \"Bearer \" + token\n          }\n        }).then(function (res) {\n          console.log(res.data);\n          Swal.fire({\n            text: \"Modification du Mot de passe réussi !\",\n            footer: \"Redirection en cours...\",\n            icon: \"success\",\n            timer: 1000,\n            showConfirmButton: false,\n            timerProgressBar: true,\n            willClose: function willClose() {\n              location.reload();\n            }\n          });\n        }).catch(function (error) {\n          console.log(error.response.data.error);\n        });\n      } else {\n        alert(\"Mot de passe non confirmé\");\n      }\n    },\n    // Update BIO\n    updateBio: function updateBio() {\n      var local = JSON.parse(localStorage.user);\n      var userId = local.userId;\n      var token = local.token;\n      axios.put(\"http://localhost:3000/auth/update/\" + userId, {\n        bio: this.newBio\n      }, {\n        headers: {\n          Authorization: \"Bearer \" + token\n        }\n      }).then(function (res) {\n        console.log(res.data);\n        Swal.fire({\n          text: \"Modification de la bio réussie\",\n          footer: \"Redirection en cours...\",\n          icon: \"success\",\n          timer: 1000,\n          showConfirmButton: false,\n          timerProgressBar: true,\n          willClose: function willClose() {\n            location.reload();\n          }\n        });\n      }).catch(function (error) {\n        console.log(error.response.data.error);\n      });\n    },\n    // Delete User\n    deleteUser: function deleteUser() {\n      var _this = this;\n\n      var local = JSON.parse(localStorage.user);\n      var token = local.token;\n      axios.delete(\"http://localhost:3000/auth/delete\", {\n        headers: {\n          Authorization: \"Bearer \" + token\n        },\n        data: local\n      }).then(function (res) {\n        console.log(res); //localStorage.removeItem(\"connectedUser\");\n\n        Swal.fire({\n          text: \"Compte supprimé\",\n          footer: \"Redirection en cours...\",\n          icon: \"success\",\n          timer: 1000,\n          showConfirmButton: false,\n          timerProgressBar: true,\n          willClose: function willClose() {\n            localStorage.clear();\n\n            _this.$router.push(\"/\");\n          }\n        });\n      }).catch(function (error) {\n        console.log(error.response.data.error);\n      });\n    },\n    // Récupération de l'utilisateur\n    getUser: function getUser() {\n      var _this2 = this;\n\n      var local = JSON.parse(localStorage.user);\n      var userId = local.userId;\n      var token = local.token;\n      axios.get(\"http://localhost:3000/auth/\" + userId, {\n        headers: {\n          Authorization: \"Bearer \" + token\n        }\n      }).then(function (res) {\n        _this2.user = res.data;\n      }).catch(function (error) {\n        console.log(error.response.data.error);\n      });\n    }\n  },\n  created: function created() {\n    this.getUser();\n  }\n};","map":{"version":3,"mappings":"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","names":["name","data","user","newEmail","newBio","newUser","email","password","cPassword","bio","image","methods","exitSession","localStorage","returnMain","updateImg","formData","axios","put","userId","headers","Authorization","then","console","Swal","text","footer","icon","timer","showConfirmButton","timerProgressBar","willClose","location","catch","alert","updateEmail","updatePassword","updateBio","deleteUser","delete","getUser","get","created"],"sourceRoot":"src/views","sources":["AccountView.vue"],"sourcesContent":["<template>\n  <v-app>\n    <v-card width=\"100%\" max-width=\"800\" class=\"mx-auto overflow-hidden\">\n      <v-app-bar color=\"red lighten-4\">\n        <v-btn @click=\"returnMain\" class=\"ma-2\" color=\"red lighten-3\" dark>\n          Fil d'actu\n          <v-icon dark right> mdi-chat-processing </v-icon>\n        </v-btn>\n        <v-spacer></v-spacer>\n        <v-toolbar-title>Mon compte</v-toolbar-title>\n        <v-spacer></v-spacer>\n\n        <v-btn @click=\"exitSession\" class=\"ma-2\" color=\"red lighten-3\" dark>\n          Quitter\n          <v-icon dark right> mdi-cancel </v-icon>\n        </v-btn>\n      </v-app-bar>\n\n      <div class=\"accountCont\">\n        <div\n          class=\"userPict\"\n          :style=\"{ backgroundImage: 'url(' + this.user[0][`image`] + ')' }\"\n        ></div>\n        <div class=\"infoUser\">\n          <h3>Prenom : {{ this.user[0][\"prenom\"] }}</h3>\n          <h3>email : {{ this.user[0][\"email\"] }}</h3>\n          <div class=\"bio\">\n            <h3>Ma bio :</h3>\n            <p>{{ this.user[0][\"bio\"] }}</p>\n          </div>\n        </div>\n        <div class=\"update\">\n          <h2>Modifier ses informations :</h2>\n          <form class=\"formUpdate\">\n            <div class=\"formDiv\">\n              <label for=\"newEmail\">Modifier l'adresse email</label>\n              <input\n                type=\"text\"\n                name=\"newEmail\"\n                id=\"newEmail\"\n                placeholder=\"Adresse mail valide\"\n                v-model=\"newEmail\"\n              />\n              <button class=\"formBtn\" @click.prevent=\"updateEmail\">\n                Modifier\n              </button>\n            </div>\n\n            <div class=\"formDiv\">\n              <label for=\"newPassword\">Modifier le mot de passe </label>\n              <input\n                type=\"password\"\n                name=\"newPassword\"\n                id=\"newPassword\"\n                placeholder=\"6 caractères minimum\"\n                v-model=\"newPassword\"\n              />\n              <label for=\"newPasswordConfirm\">Confirmer le mot de passe</label>\n              <input\n                type=\"password\"\n                name=\"newPasswordConfirm\"\n                id=\"NewPasswordConfirm\"\n                placeholder=\"6 caractères minimum\"\n                v-model=\"newPasswordConfirm\"\n              />\n              <button class=\"formBtn\" @click.prevent=\"updatePassword\">\n                Modifier\n              </button>\n            </div>\n\n            <div class=\"formDiv\">\n              <label for=\"newImg\">Modifier image du profil</label>\n              <input\n                type=\"text\"\n                name=\"newImg\"\n                id=\"newImg\"\n                placeholder=\"Copier ici l'url de votre image\"\n                v-model=\"newImg\"\n              />\n              <button class=\"formBtn\" @click.prevent=\"updateImg\">\n                Modifier\n              </button>\n            </div>\n\n            <div class=\"formDiv\">\n              <label for=\"newBio\">Modifier la biographie</label>\n              <textarea\n                name=\"newBio\"\n                id=\"newBio\"\n                v-model=\"newBio\"\n              ></textarea>\n              <button class=\"formBtn\" @click.prevent=\"updateBio\">\n                Modifier\n              </button>\n            </div>\n          </form>\n        </div>\n        <button class=\"btnDelete\" @click.prevent=\"deleteUser\">\n          Supprimer Compte\n        </button>\n      </div>\n    </v-card>\n  </v-app>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\n\nexport default {\n  name: \"App\",\n\n  data() {\n    return {\n      user: {},\n      //TEST A CONFIRMER\n      newEmail:\"\",\n      newBio:\"\",\n\n\n      newUser: {\n        email: \"\",\n        password: \"\",\n        cPassword: \"\",\n        bio: \"\",\n        image: \"\",\n      },\n    };\n  },\n\n  methods: {\n    exitSession() {\n      this.$router.push(\"/\");\n      localStorage.clear();\n    },\n    returnMain() {\n      this.$router.push(\"/main\");\n    },\n    \n    \n    // Update img\n    updateImg() {\n      if (this.newUser.image !== \"\") {\n        const userId = this.currentUser.userId;\n        const formData = new FormData();\n        formData.append(\"image\", this.newUser.image);\n        axios\n          .put(`http://localhost:3000/api/users/${userId}`, formData, {\n            headers: {\n              \"content-type\": \"multipart/form-data\",\n              Authorization: \"Bearer \" + this.currentUser.token,\n            },\n          })\n          .then((res) => {\n            console.log(res.data);\n            Swal.fire({\n              text: \"Modification image réussie\",\n              footer: \"Redirection en cours...\",\n              icon: \"success\",\n              timer: 1000,\n              showConfirmButton: false,\n              timerProgressBar: true,\n              willClose: () => {\n                location.reload();\n              },\n            });\n          })\n          .catch((error) => {\n            console.log(error.response.data.error);\n          });\n      } else {\n        alert(\"Choisissez une image !\");\n      }\n    },\n    // Update EMAIL\n    updateEmail() {\n      let local = JSON.parse(localStorage.user);\n      let userId = local.userId;\n      let token = local.token;\n\n      axios\n        .put(\n          \"http://localhost:3000/auth/update/\" + userId,\n          { email: this.newEmail },\n          {\n            headers: {\n              Authorization: \"Bearer \" + token,\n            },\n          }\n        )\n        .then((res) => {\n          console.log(res.data);\n          Swal.fire({\n            text: \"Modification de l'adresse Email réussie !\",\n            footer: \"Redirection en cours...\",\n            icon: \"success\",\n            timer: 1000,\n            showConfirmButton: false,\n            timerProgressBar: true,\n            willClose: () => {\n              location.reload();\n            },\n          });\n        })\n        .catch((error) => {\n          console.log(error.response.data.error);\n        });\n    },\n    // Update PASSWORD\n    updatePassword() {\n      let local = JSON.parse(localStorage.user);\n      let userId = local.userId;\n      let token = local.token;\n\n        if (this.newPassword === this.newPasswordConfirm) {\n          \n          axios\n            .put(\n              `http://localhost:3000/auth/update/`+ userId,\n              { password: this.newPassword },\n              {\n                headers: {\n                  Authorization: \"Bearer \" + token,\n                },\n              }\n            )\n            .then((res) => {\n              console.log(res.data);\n              Swal.fire({\n                text: \"Modification du Mot de passe réussi !\",\n                footer: \"Redirection en cours...\",\n                icon: \"success\",\n                timer: 1000,\n                showConfirmButton: false,\n                timerProgressBar: true,\n                willClose: () => {\n                  location.reload();\n                },\n              });\n            })\n            .catch((error) => {\n              console.log(error.response.data.error);\n            });\n        } else {\n          alert(\"Mot de passe non confirmé\");\n        }\n    },\n\n    // Update BIO\n    updateBio() {\n      let local = JSON.parse(localStorage.user);\n      let userId = local.userId;\n      let token = local.token;\n        axios\n          .put(\n            \"http://localhost:3000/auth/update/\"+ userId,\n            { bio: this.newBio },\n            {\n              headers: {\n                Authorization: \"Bearer \" + token,\n              },\n            }\n          )\n          .then((res) => {\n            console.log(res.data);\n            Swal.fire({\n              text: \"Modification de la bio réussie\",\n              footer: \"Redirection en cours...\",\n              icon: \"success\",\n              timer: 1000,\n              showConfirmButton: false,\n              timerProgressBar: true,\n              willClose: () => {\n                location.reload();\n              },\n            });\n          })\n          .catch((error) => {\n            console.log(error.response.data.error);\n          });\n    },\n    // Delete User\n    deleteUser() {\n      let local = JSON.parse(localStorage.user);\n\n      let token = local.token;\n      axios\n        .delete(\"http://localhost:3000/auth/delete\", {\n          headers: {\n            Authorization: \"Bearer \" + token,\n          },\n          data: local,\n        })\n        .then((res) => {\n          console.log(res);\n          //localStorage.removeItem(\"connectedUser\");\n          Swal.fire({\n            text: \"Compte supprimé\",\n            footer: \"Redirection en cours...\",\n            icon: \"success\",\n            timer: 1000,\n            showConfirmButton: false,\n            timerProgressBar: true,\n            willClose: () => {\n              localStorage.clear();\n              this.$router.push(\"/\");\n            },\n          });\n        })\n        .catch((error) => {\n          console.log(error.response.data.error);\n        });\n    },\n    // Récupération de l'utilisateur\n    getUser() {\n      let local = JSON.parse(localStorage.user);\n      let userId = local.userId;\n      let token = local.token;\n\n      axios\n        .get(\"http://localhost:3000/auth/\" + userId, {\n          headers: {\n            Authorization: \"Bearer \" + token,\n          },\n        })\n        .then((res) => {\n          this.user = res.data;\n        })\n        .catch((error) => {\n          console.log(error.response.data.error);\n        });\n    },\n  },\n  created() {\n    this.getUser();\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.accountCont {\n  width: 95%;\n  margin: 10px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: white;\n}\n.infoUser {\n  display: flex;\n  flex-direction: column;\n  align-items: baseline;\n  width: 40%;\n}\n\n.bio {\n  width: 100%;\n  font-weight: lighter;\n}\n\n.userPict {\n  width: 180px;\n  height: 180px;\n  background-position: center;\n  background-size: cover;\n  border: 1px solid rgb(61, 66, 66);\n  border-radius: 50%;\n  margin: 20px 0px 20px 0px;\n}\n\n.formUpdate {\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap;\n}\n.formDiv {\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-evenly;\n  margin: 15px;\n  padding: 10px;\n  border: 1px solid rgb(199, 199, 199);\n  border-radius: 10px;\n}\n\nh2 {\n  display: flex;\n  justify-content: center;\n  margin: 10px 0px 10px 0px;\n}\n\nh3 {\n  margin: 10px 0px;\n}\n\nlabel {\n  font-weight: bold;\n  margin: 10px;\n}\ninput {\n  margin: 10px;\n  border-radius: 5px;\n  border: 1px solid rgb(199, 199, 199);\n}\ntextarea {\n  height: 80px;\n  border: 1px solid darkslategray;\n}\n\n.formBtn {\n  margin: 10px;\n  padding: 10px;\n  background-color: rgb(109, 182, 109);\n  border: 1px solid rgb(109, 182, 109);\n  border-radius: 15px;\n  color: white;\n  cursor: pointer;\n\n  &:hover {\n    transform: scale(1.05);\n    transition: 0.8s;\n  }\n}\n\n.btnDelete {\n  margin: 30px;\n  padding: 20px;\n  background-color: rgb(253, 106, 106);\n  border: 1px solid rgb(253, 106, 106);\n  color: white;\n  cursor: pointer;\n  border-radius: 15px;\n\n  &:hover {\n    transform: scale(1.05);\n    transition: 0.8s;\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}